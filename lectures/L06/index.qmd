---
title: "MATE 664 Lecture 06"
subtitle: "Solution to Diffusion Equations (I)"
author: "Dr. Tian Tian"
date: "2026-01-21"
format:
  html: {}
  revealjs:
    output-file: slides.html
  pdf:	 
    output-file: L06.pdf
---

::: {.content-visible when-format="html" unless-format="revealjs"}

::: {.callout-note}
- Slides üëâ  [Open presentationüóíÔ∏è](./slides.html)
- PDF version of course note  üëâ [Open in pdf](./L06.pdf)
- Handwritten notes üëâ [Open in pdf](./public/L06_annotated.pdf)
:::

:::


## Recap of Lecture 05 {.center}
Key ideas from last lecture:

- Different forms of diffusivities
- Deriving diffusivity from driving force terms
- Differentiate reference frames used for diffusion equations

## Recap: Intrinsic Diffusivity Expression

For component $i$ (notation from notes)

$$
D_i^* = k_B T \left(\frac{L_{ii}}{c_i} - \frac{L_{ij}}{c_j}\right)
$$


$$
D_i = k_B T\left(\frac{L_{ii}}{c_i}-\frac{L_{ij}}{c_j}\right)
\left(1+\frac{\partial \ln \gamma_i}{\partial \ln c_i}\right)
$$

whereas

$$
\Phi(c) = 1+\frac{\partial \ln \gamma_i}{\partial \ln c_i}
$$

## Recap: Interdiffusivity (Binary)

Binary mixture

$$
\tilde D_{12} = D_1 c_2 \Omega_2 + D_2 c_1 \Omega_1
$$

- $\Omega_i$: partial molar volume factor in your notation
- Both C-frame and V-frame still lead to Fick-type equations

---

## Learning Outcomes {.center}

After today's lecture, you will be able to:

- Interpret Kirkendall effect using lattice (C-frame) vs lab (V-frame)
- Solve steady-state diffusion (Laplace equation) in common geometries
- Use non-steady solutions: Gaussian / error function / superposition
- Use separation of variables and Laplace transform as solution strategies


## Remaining Question 1: Kirkendall Effect

![Kirkendall effect demo](./public/kirkendall.png){width="100%"}

Key observation

- In diffusion couple, markers move relative to lab frame
- Indicates unequal intrinsic fluxes in lattice frame

---

## C-frame vs V-frame Fluxes

**C-frame** (lattice frame)

- net lattice flux can be nonzero: $J_V^*\neq 0$

**V-frame** (lab frame)

$$
J_A^V = -J_B^V,\qquad J_V^V = 0
$$

Interpretation

- $J_V^*\neq 0$ but $J_V^V=0$ implies defect accumulation / depletion

---

## Kirkendall Effect: Physical Meaning

Experimentally measured lattice shift

- Markers track lattice (or marker plane)
- Unequal intrinsic fluxes $\Rightarrow$ vacancy flux
- Vacancy imbalance $\Rightarrow$ defect accumulation in control volume
- Can produce porosity (Kirkendall voids)

---

## Kirkendall Effect: Analog

![](./public/kirkendall-analog.svg){width="80%"}

- A diffuse faster than B across the membrane
- $p_i = c_i RT$
- Fixed membrane üëâ expanding voids


## Kirkendall Effect: Simulations

See [simulation of vacancy mechanism](https://www.doitpoms.ac.uk/tlplib/diffusion/HTML5/kirkendall.html)

_Credit: Dissemination of IT for the Promotion of Materials Science (DoITPoMS), University of Cambridge_

---

## Remaining Question 2: Interstitial Diffusion Setup

![Interstitial diffusion](./public/Interstitial-diffusion-1024x575.jpg){width="75%"}

Model ideas:

- species 1 diffuses through sites of 2 (interstitial)
- atoms of 2 are much heavier than 1
- what is the interdiffusivity $\tilde{D}$?

---

## Mobility and Diffusivity in C-frame

C-frame velocity

$$
v_s^* = \frac{M_1}{c_1}\nabla \mu_1
$$

Then

$$
D_1 = M_1 k_B T
$$

and (using Onsager coefficient notation)

$$
D_1 = \frac{L_{11}}{c_1} k_B T
$$

Connection

- this matches Nernst‚ÄìEinstein type relation

---

## V-frame Analysis

Special Case: Diffusivity of 2 ‚Üí 1 with $D_2=0$

- species 2 immobile: $D_2=0
- drift velocity related to $\partial c_1/\partial x$
- similar to ‚Äúdiffusion through solvent‚Äù in mass transfer

```{=tex}
\begin{align}
J_1^V &= -D_1 \frac{\partial c_1}{\partial x} 
+ c_1 (D_1 - 0) \Omega_1 \frac{\partial c_1} {\partial x} \\
&= -D_1 \left(
1 - c_1 \Omega_1
\right) \frac{\partial c_1} {\partial x} \\
\end{align}
```



## V-frame: Effective Diffusivity

The interdiffusivity now becomes:

```{=tex}
\begin{align}
\tilde{D} &= D_1 \Omega_2 c_2 \\
          &= D_1 x_2
\end{align}
```

- $x_2$ is the fraction of lattice particles (usually 1).
- interdiffusivity depends on "how many sites" the smaller species can use
- this expression only applicable for interstitial diffusion!

## Driving Forces Beyond Chemical Potential

We often used $\mu_i$ as driving force for diffusion, but
other contributions  exist.

Generalized ‚Äúdiffusion potential‚Äù:

$$
\Phi_i = \mu_i + \sum_j \eta_j
$$

- vacancy mechanism / site availability
- electromigration
- external pressure / stress effects
- capillarity / surface curvature effects
- etc.

## How Do We Determine $D$?

General experimental workflow:

- impose initial concentration + geometry
- evolve for time $t>0$
- measure profile $c(x,t)$ (or length scale)
- fit to model solution $\Rightarrow D$

---

## Forward Problem vs Inverse Problem

**Given**

- geometry + initial/boundary conditions
- candidate $D$

**Predict**

- concentration profile $c(x,t)$

**Inverse**

- infer $D$ from measured $c(x,t)$


## What Do We Learn In The Following Lectures?

- We want **analytical** + **numerical** solutions to the diffusion equations (Fick's laws)

- Start with steady state, then non-steady state.

- Covering general formula, and geometries

---

## Fick‚Äôs Second Law (1D, constant $D$)

Assuming homogeneous isotropic constant $D$

$$
\frac{\partial c}{\partial t}=D\frac{\partial^2 c}{\partial x^2}
$$

To solve we must specify

- initial condition: $c(x,0)$
- boundary conditions: $c(0,t)$, $c(L,t)$ or flux BC

<!-- --- -->

<!-- ## Strategy Roadmap (Non-steady) -->

<!-- From notes -->

<!-- - superposition + known source solutions -->
<!-- - separation of variables -->
<!-- - Laplace transform (time ‚Üí $p$ domain) -->
<!-- - numerical solution -->

---

## Part I: Steady State Diffusion

Steady state

$$
\frac{\partial c}{\partial t}=0
\quad\Rightarrow\quad
\nabla^2 c = 0
$$

This is Laplace equation, having solution in 1D:

$$
\frac{d^2 c}{dx^2}=0
\Rightarrow
c(x)=C_1 x + C_2
$$

---

## 1D Steady State: Dirichlet BC Example

If $c(0)=c^0$ and $c(L)=c^L$

Then

$$
c(x)=c^0+\frac{c^L-c^0}{L}x
$$

and flux

$$
J=-D\frac{dc}{dx}
= -D\frac{c^L-c^0}{L}
$$

---

## Cylindrical Steady State (Radial)

For axisymmetric $c=c(r)$

$$
\nabla^2 c=\frac{1}{r}\frac{d}{dr}\left(r\frac{dc}{dr}\right)=0
$$

Integrate twice

$$
c(r)=k_1\ln r+k_2
$$

---

## Cylinder: Apply BC at $r_1, r_2$

If $c(r_1)=c_1$ and $c(r_2)=c_2$

Then

$$
c(r)=c_1+\frac{c_2-c_1}{\ln(r_2/r_1)}\ln\left(\frac{r}{r_1}\right)
$$

---

## Spherical Steady State (Radial)

For $c=c(r)$

$$
\nabla^2 c=\frac{1}{r^2}\frac{d}{dr}\left(r^2\frac{dc}{dr}\right)=0
$$

Integrate to get

$$
c(r)=-\frac{k_1}{r}+k_2
$$

---

## Sphere: Apply BC at $r_1, r_2$

If $c(r_1)=c_1$, $c(r_2)=c_2$

One convenient form

$$
c(r)=c_1+\frac{c_2-c_1}{\left(\frac{1}{r_2}-\frac{1}{r_1}\right)}
\left(\frac{1}{r}-\frac{1}{r_1}\right)
$$

---

## Spatially Varying Diffusivity in Steady State

Notes: still solvable if $D$ depends on 1 variable (e.g. $x$ or $r$)

Steady 1D with constant flux $J$

$$
J=-D(x)\frac{dc}{dx}=\text{const}
$$

So

$$
\frac{dc}{dx}=-\frac{J}{D(x)}
\Rightarrow
c(x)=c(x_0)-J\int_{x_0}^x\frac{1}{D(\xi)}\,d\xi
$$

Often requires numerical integration for $D(\xi)$.

- Dirchlet boundary üëâ directly integration
- Neumann boundary üëâ need to fix $dc/dx$ at boundary

## Part II: Non-steady State Diffusion

Different strategies

- superposition with known ‚Äúsource‚Äù solutions
- separation of variables (finite domains)
- Laplace transform (initial condition handling)
- numerical methods (general geometry / $D(c)$)

---

## Method 1: Superposition of Known Solutions

Use linearity of diffusion equation

If $c_a$ and $c_b$ satisfy the PDE and BCs, then

$$
c = c_a + c_b
$$

also satisfies (with compatible IC/BC decomposition).

---

## Inifinite Space: Half-Half Situation 

Geometry: $x\ge 0$

I.C.

- $c(x<0,t=0)=c_L$
- $c(x>0,t=0)=c_R$

Solution form

$$
c(x,t)=\frac{c_L + c_R}{2} + \frac{c_L-c_R}{2}\,\operatorname{erf}\left(\frac{x}{\sqrt{2Dt}}\right)
$$

How do we get here?

---

## Limits and Checks

- $t\to 0^+$: $\operatorname{erfc}(x/(2\sqrt{Dt}))\to 0$ for $x>0$ ‚áí $c\to c_B$
- $x\to 0$: $\operatorname{erfc}(0)=1$ ‚áí $c(0,t)=c_A$
- $x\to\infty$: $\operatorname{erfc}(\infty)=0$ ‚áí $c\to c_B$

<!-- --- -->

<!-- ## Line Source as Superposition -->

<!-- Notes: ‚Äúline source‚Äù can be built from two semi-infinite problems -->

<!-- <\!-- ![](./public/placeholder-image-2.png) -\-> -->

<!-- Idea -->

<!-- - decompose initial profile into steps -->
<!-- - add corresponding erfc solutions -->

<!-- ## Infinite Domain: Point Source (1D) -->

<!-- Initial conditions -->

<!-- $$ -->
<!-- c(x,0)=N\,\delta(x) -->
<!-- $$ -->

<!-- Solution -->

<!-- $$ -->
<!-- c(x,t)=\frac{N}{\sqrt{4\pi Dt}} -->
<!-- \exp\left(-\frac{x^2}{4Dt}\right) -->
<!-- $$ -->

<!-- --- -->

<!-- ## Gaussian Interpretation -->

<!-- - point source spreads as a Gaussian -->
<!-- - variance grows linearly with time -->

<!-- $$ -->
<!-- \sigma^2 = 2Dt -->
<!-- $$ -->

<!-- So width $\sigma\sim\sqrt{2Dt}$. -->

<!-- --- -->

<!-- ## Error Function and Gaussian Integral -->

<!-- Define -->

<!-- $$ -->
<!-- \operatorname{erf}(z)=\frac{2}{\sqrt{\pi}}\int_0^{z}e^{-s^2}\,ds -->
<!-- $$ -->

<!-- and -->

<!-- $$ -->
<!-- \operatorname{erfc}(z)=1-\operatorname{erf}(z) -->
<!-- $$ -->

<!-- These appear in semi-infinite diffusion solutions. -->


<!-- --- -->

<!-- ## Step Source -->

<!-- Finite step (width $\Delta x$) can be treated as -->

<!-- - difference of two semi-infinite step solutions -->
<!-- - in the limit $\Delta x\to 0$ recovers point source Gaussian -->

<!-- --- -->

<!-- ## 3D Point Source -->

<!-- $c$ is separabile across axes! -->

<!-- For 3D infinite space -->

<!-- $$ -->
<!-- c(x,y,z,t)=\frac{N}{(4\pi Dt)^{3/2}} -->
<!-- \exp\left(-\frac{x^2+y^2+z^2}{4Dt}\right) -->
<!-- $$ -->

<!-- --- -->

<!-- ## General Principle: Linear PDE ‚Üí Build Solutions -->

<!-- Because diffusion equation is linear (for constant $D$) -->

<!-- - complex IC can be decomposed into simpler components -->
<!-- - solutions are sums (or integrals) of known kernels -->

<!-- Hard part -->

<!-- - enforcing boundary conditions in finite domains -->

<!-- --- -->

<!-- ## Method 2: Separation of Variables -->

<!-- Used often for finite domains -->

<!-- Assume product form -->

<!-- $$ -->
<!-- c(x,t)=X(x)\,T(t) -->
<!-- $$ -->

<!-- Substitute into -->

<!-- $$ -->
<!-- \frac{\partial c}{\partial t}=D\frac{\partial^2 c}{\partial x^2} -->
<!-- $$ -->

<!-- gives -->

<!-- $$ -->
<!-- \frac{1}{DT}\frac{dT}{dt}=\frac{1}{X}\frac{d^2X}{dx^2}=-\lambda^2 -->
<!-- $$ -->

<!-- --- -->

<!-- ## Time Part and Spatial Eigenfunctions -->

<!-- Time ODE -->

<!-- $$ -->
<!-- \frac{dT}{dt}=-\lambda^2 D\,T -->
<!-- \Rightarrow -->
<!-- T(t)=\exp(-\lambda^2 Dt) -->
<!-- $$ -->

<!-- Space ODE -->

<!-- $$ -->
<!-- \frac{d^2X}{dx^2}+\lambda^2 X=0 -->
<!-- $$ -->

<!-- Solutions depend on BCs (sine/cosine, etc.). -->

<!-- --- -->

<!-- ## Eigenvalues from Boundary Conditions -->

<!-- - Dirichlet BC ‚áí $\lambda_n = n\pi/L$ -->
<!-- - Neumann BC ‚áí $\lambda_n = n\pi/L$ with different eigenfunctions -->
<!-- - Mixed BC ‚áí different transcendental conditions -->

<!-- Physical meaning in notes -->

<!-- - $\lambda$ sets spatial wavelength $\sim 1/\lambda$ -->
<!-- - higher $n$ modes decay faster (via $e^{-\lambda^2Dt}$) -->

<!-- --- -->

<!-- ## General Series Solution Form -->

<!-- Superposition over modes -->

<!-- $$ -->
<!-- c(x,t)=\sum_{n=0}^{\infty} A_n X_n(x)\,e^{-\lambda_n^2Dt} -->
<!-- $$ -->

<!-- Coefficients $A_n$ from initial condition projection. -->

<!-- --- -->

<!-- ## Modal Picture: What Decays First? -->

<!-- - high spatial-frequency components (large $\lambda_n$) vanish quickly -->
<!-- - long-wavelength components persist longer -->
<!-- - diffusion acts as a low-pass filter on concentration profiles -->

<!-- --- -->

<!-- ## Method 3: Laplace Transform (Time Domain) -->

<!-- Notes: convert time-dependence into algebraic parameter $p$ -->

<!-- Define -->

<!-- $$ -->
<!-- \hat c(x,p)=\mathcal{L}\{c(x,t)\} -->
<!-- =\int_{0}^{\infty} e^{-pt}c(x,t)\,dt -->
<!-- $$ -->

<!-- Laplace transform replaces time derivative with initial-value term. -->

<!-- --- -->

<!-- ## Key Property: Transform of $\partial c/\partial t$ -->

<!-- Using integration by parts (as in notes) -->

<!-- $$ -->
<!-- \mathcal{L}\left\{\frac{\partial c}{\partial t}\right\} -->
<!-- = p\hat c(x,p) - c(x,0) -->
<!-- $$ -->

<!-- Spatial derivatives remain derivatives in $x$: -->

<!-- $$ -->
<!-- \mathcal{L}\left\{\frac{\partial^2 c}{\partial x^2}\right\} -->
<!-- =\frac{\partial^2 \hat c}{\partial x^2} -->
<!-- $$ -->

<!-- --- -->

<!-- ## Fick‚Äôs 2nd Law in Laplace Space -->

<!-- Transform -->

<!-- $$ -->
<!-- \frac{\partial c}{\partial t}=D\frac{\partial^2 c}{\partial x^2} -->
<!-- $$ -->

<!-- becomes -->

<!-- $$ -->
<!-- p\hat c(x,p)-c(x,0)=D\frac{\partial^2 \hat c}{\partial x^2} -->
<!-- $$ -->

<!-- Now an ODE in $x$ (parameter $p$). -->

<!-- --- -->

<!-- ## Example Setup: Semi-infinite with Fixed Surface -->

<!-- From notes example -->

<!-- - $c(x,0)=0$ for $x>0$ -->
<!-- - $c(0,t)=c_0$ -->
<!-- - $c(\infty,t)=0$ -->

<!-- Boundary conditions in Laplace domain -->

<!-- $$ -->
<!-- \hat c(0,p)=\frac{c_0}{p}, -->
<!-- \qquad -->
<!-- \hat c(\infty,p)=0 -->
<!-- $$ -->

<!-- --- -->

<!-- ## Solve ODE in $x$ -->

<!-- With $c(x,0)=0$, equation reduces to -->

<!-- $$ -->
<!-- D\frac{\partial^2 \hat c}{\partial x^2}-p\hat c=0 -->
<!-- $$ -->

<!-- General solution -->

<!-- $$ -->
<!-- \hat c(x,p)=A e^{+\sqrt{p/D}\,x}+B e^{-\sqrt{p/D}\,x} -->
<!-- $$ -->

<!-- Semi-infinite boundedness ‚áí $A=0$. -->

<!-- --- -->

<!-- ## Apply BC at $x=0$ -->

<!-- At $x=0$ -->

<!-- $$ -->
<!-- \hat c(0,p)=B=\frac{c_0}{p} -->
<!-- $$ -->

<!-- So -->

<!-- $$ -->
<!-- \hat c(x,p)=\frac{c_0}{p}\exp\left(-\sqrt{\frac{p}{D}}\,x\right) -->
<!-- $$ -->

<!-- --- -->

<!-- ## Back-transform: Error Function Result -->

<!-- Inverse Laplace yields the erfc solution (notes) -->

<!-- $$ -->
<!-- c(x,t)=c_0\,\operatorname{erfc}\left(\frac{x}{2\sqrt{Dt}}\right) -->
<!-- $$ -->

<!-- Interpretation -->

<!-- - Laplace method packaged IC automatically into transformed equation -->
<!-- - remaining work: solve ODE in $x$ + apply BCs -->

<!-- --- -->

<!-- ## General Laplace Workflow (Notes Summary) -->

<!-- 1) Write PDE and IC/BC   -->
<!-- 2) Laplace in time: $c\to \hat c(x,p)$   -->
<!-- 3) Solve ODE in $x$ (parameter $p$)   -->
<!-- 4) Fit BCs (Dirichlet / Neumann) to get coefficients   -->
<!-- 5) Invert transform (analytic or numeric) -->

<!-- --- -->

<!-- ## Meaning of the $p$-space Parameter -->

<!-- From your sketch (page 17) -->

<!-- - $\hat c(x,p)$ is a weighted time integral of $c(x,t)$ -->
<!-- - large $p$ emphasizes early-time behavior -->
<!-- - small $p$ emphasizes long-time behavior -->

<!-- Conceptual plots -->

<!-- - $c(x,t)$ evolves in $t$ -->
<!-- - $\hat c(x,p)$ ‚Äúcompresses‚Äù time into the $p$ axis -->

<!-- --- -->

<!-- ## When to Use Which Method? -->

<!-- - Known source solutions + superposition -->
<!--   - infinite / semi-infinite, simple BCs -->
<!-- - Separation of variables -->
<!--   - finite domains, classical BCs, eigenfunction expansions -->
<!-- - Laplace transform -->
<!--   - strong control over initial conditions, semi-infinite problems -->
<!-- - Numerical -->
<!--   - complex geometry, nonlinear $D(c)$, complicated BCs -->

<!-- --- -->

<!-- ## Summary -->

<!-- - Steady state ‚áí Laplace equation $\nabla^2 c=0$ (solve by geometry) -->
<!-- - Non-steady constant-$D$ diffusion is linear -->
<!-- - Key kernels: Gaussian (point source) and erfc (semi-infinite boundary) -->
<!-- - Separation of variables: eigenmodes decay as $e^{-\lambda_n^2Dt}$ -->
<!-- - Laplace transform: time derivative becomes $p\hat c - c(x,0)$, ODE in $x$ -->

<!-- --- -->

## Next Steps

- Apply these solutions to real diffusion experiments
- Extract $D$ by fitting measured $c(x,t)$
- Extend to variable $D(c)$ and coupled diffusion (later)

















